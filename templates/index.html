<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gradient Image Generator</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1>Gradient Image Generator</h1>
    <form id="imageForm">
        <label for="text">Text:</label>
        <input type="text" id="text" name="text" required><br><br>

        <label for="startColor">Start Color:</label>
        <input type="color" id="startColor" name="startColor" required><br><br>

        <label for="endColor">End Color:</label>
        <input type="color" id="endColor" name="endColor" required><br><br>

        <label for="width">Width: <span id="widthValue">500</span>px</label>
        <input type="range" id="width" name="width" min="100" max="1000" value="500" oninput="updateSliderValue('width')"><br><br>

        <label for="height">Height: <span id="heightValue">500</span>px</label>
        <input type="range" id="height" name="height" min="100" max="1000" value="500" oninput="updateSliderValue('height')"><br><br>

        <button type="submit">Generate Image</button>
    </form>

    <div id="imageContainer"></div>
    <a id="downloadLink" style="display: none;">Download Image</a>

    <script>
        function updateSliderValue(sliderId) {
            const slider = document.getElementById(sliderId);
            const valueSpan = document.getElementById(sliderId + 'Value');
            valueSpan.textContent = slider.value;
        }

        // 페이지 로드 시 초기값 설정
        window.onload = function() {
            updateSliderValue('width');
            updateSliderValue('height');
        };

        document.getElementById('imageForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            formData.set('start_color', document.getElementById('startColor').value.substring(1));
            formData.set('end_color', document.getElementById('endColor').value.substring(1));

            const response = await axios.post('/generate', formData);
            const imageContainer = document.getElementById('imageContainer');
            imageContainer.innerHTML = `<img src="data:image/png;base64,${response.data.image}" alt="Generated Image">`;

            const downloadLink = document.getElementById('downloadLink');
            downloadLink.style.display = 'block';
            downloadLink.href = `/download?text=${formData.get('text')}&start_color=${formData.get('start_color')}&end_color=${formData.get('end_color')}&width=${formData.get('width')}&height=${formData.get('height')}`;
        });
    </script>
</body>
</html>